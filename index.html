<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Agregar Horarios</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  input, select, button { margin: 5px 0; padding: 5px; }
  .horario { margin-bottom: 10px; }
</style>
</head>
<body>
<h1>Agregar Horarios de Profesionales</h1>

<label>Profesional:</label>
<input type="text" id="profesional" placeholder="Ej: Pepe"><br>

<div id="horarios-container"></div>

<button type="button" onclick="agregarHorario()">Agregar horario</button><br>
<button type="button" onclick="enviarHorarios()">Enviar horarios</button>

<script>
const URL_APPS_SCRIPT = "https://script.google.com/macros/s/AKfycbx1vaVIqb6l1bN8Yd0zkOcRN3urqqR3rt9-Fjr2iiL_j0EpG-W2jsqFKmuZnRsBkIOhWQ/exec"; // reemplaza con tu URL web app

function agregarHorario() {
  const container = document.getElementById("horarios-container");
  const div = document.createElement("div");
  div.className = "horario";

  const select = document.createElement("select");
  select.className = "dia";
  ["Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Domingo"].forEach(d=>{
    const option = document.createElement("option");
    option.value = d;
    option.textContent = d;
    select.appendChild(option);
  });

  const inputInicio = document.createElement("input");
  inputInicio.type = "time";
  inputInicio.className = "inicio";

  const inputFin = document.createElement("input");
  inputFin.type = "time";
  inputFin.className = "fin";

  const btnQuitar = document.createElement("button");
  btnQuitar.type = "button";
  btnQuitar.textContent = "Quitar";
  btnQuitar.onclick = () => div.remove();

  div.appendChild(select);
  div.appendChild(inputInicio);
  div.appendChild(inputFin);
  div.appendChild(btnQuitar);

  container.appendChild(div);
}

function enviarHorarios() {
  const profesional = document.getElementById("profesional").value.trim();
  if(!profesional) return alert("Ingresa el nombre del profesional");

  const horariosDivs = document.querySelectorAll("#horarios-container .horario");
  const horarios = [];
  horariosDivs.forEach(div => {
    const dia = div.querySelector(".dia").value;
    const inicio = div.querySelector(".inicio").value;
    const fin = div.querySelector(".fin").value;
    if(inicio && fin) horarios.push(`${dia},${inicio},${fin}`);
  });

  if(horarios.length === 0) return alert("Agrega al menos un horario");

  const formData = new URLSearchParams();
  formData.append("profesional", profesional);
  horarios.forEach(h => formData.append("horarios", h));

  fetch(URL_APPS_SCRIPT, {
    method: "POST",
    body: formData
  })
  .then(res => res.json())
  .then(data => {
    if(data.status === "ok") {
      alert("Horarios enviados correctamente!");
      // Limpiar formulario si querés
      document.getElementById("horarios-container").innerHTML = "";
      document.getElementById("profesional").value = "";
    } else alert("Error: " + data.message);
  })
  .catch(err => alert("Error al enviar: " + err));
}

// Agregar un horario por defecto al cargar la página
agregarHorario();
</script>
</body>
</html>
