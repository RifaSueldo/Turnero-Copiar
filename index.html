<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Gesti√≥n de Horarios</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .bloque { border: 1px solid #ccc; padding: 10px; margin: 10px 0; border-radius: 5px; }
    label { display: inline-block; width: 80px; }
    input, select { margin: 5px; }
    button { margin-top: 10px; padding: 5px 10px; cursor: pointer; }
  </style>
</head>
<body>
  <h2>Cargar Horarios de Profesionales</h2>

  <label>Profesional:</label>
  <input type="text" id="profesional" placeholder="Ej: Pepe"><br><br>

  <div id="bloques-container"></div>
  <button onclick="agregarBloque()">+ Agregar bloque</button><br><br>

  <button onclick="enviarHorarios()">Guardar en hoja</button>

  <p id="respuesta"></p>

  <script>
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwNcfAPpftC7aR9cc2NFq3LHU_EJO2S8KHK067m3ySgwqYbKWMFW63W9c1VP4Vf-q3gQQ/exec"; // <- peg√° la URL de tu implementaci√≥n (termina en /exec)

    function agregarBloque() {
      const container = document.getElementById("bloques-container");
      const div = document.createElement("div");
      div.className = "bloque";
      div.innerHTML = `
        <label>D√≠a:</label>
        <select class="dia">
          <option value="Lunes">Lunes</option>
          <option value="Martes">Martes</option>
          <option value="Mi√©rcoles">Mi√©rcoles</option>
          <option value="Jueves">Jueves</option>
          <option value="Viernes">Viernes</option>
          <option value="S√°bado">S√°bado</option>
          <option value="Domingo">Domingo</option>
        </select>
        <label>Inicio:</label>
        <input type="time" class="inicio" required>
        <label>Fin:</label>
        <input type="time" class="fin" required>
        <button onclick="this.parentNode.remove()">üóëÔ∏è</button>
      `;
      container.appendChild(div);
    }

    async function enviarHorarios() {
      const profesional = document.getElementById("profesional").value.trim();
      if (!profesional) {
        alert("Ingres√° el nombre del profesional");
        return;
      }

      const bloques = [];
      document.querySelectorAll(".bloque").forEach(b => {
        const dia = b.querySelector(".dia").value;
        const inicio = b.querySelector(".inicio").value;
        const fin = b.querySelector(".fin").value;
        if (inicio && fin) {
          bloques.push({ dia, inicio, fin });
        }
      });

      if (bloques.length === 0) {
        alert("Agreg√° al menos un bloque horario");
        return;
      }

      try {
        const res = await fetch(WEB_APP_URL, {
          method: "POST",
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body: new URLSearchParams({
            profesional: profesional,
            horarios: bloques.map(b => JSON.stringify(b))
          })
        });

        const data = await res.json();
        document.getElementById("respuesta").innerText =
          data.status === "ok" ? "‚úÖ Horarios guardados con √©xito" : "‚ö†Ô∏è Error al guardar";
      } catch (err) {
        console.error(err);
        document.getElementById("respuesta").innerText = "‚ùå Error de conexi√≥n";
      }
    }
  </script>
</body>
</html>
